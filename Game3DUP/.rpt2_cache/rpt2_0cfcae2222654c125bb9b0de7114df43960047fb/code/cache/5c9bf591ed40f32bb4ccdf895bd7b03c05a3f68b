{
  "code": "import Game from \"../Game\";\r\nimport GameHitBox from \"../GameHitBox\";\r\nimport { GameMove } from \"./GameMove\";\r\nimport BoomEffect from \"../effect/BoomEffect\";\r\nexport default class MonsterBulletMove extends GameMove {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.future = new GameHitBox(2, 2);\r\n    }\r\n    move2d(n, pro, speed) {\r\n        pro.setSpeed(speed);\r\n        if (pro.speed <= 0)\r\n            return;\r\n        if (pro.sysBullet.bulletBlock == 1) {\r\n            var vx = pro.speed * Math.cos(n);\r\n            var vz = pro.speed * Math.sin(n);\r\n            var x0 = pro.hbox.cx;\r\n            var y0 = pro.hbox.cy;\r\n            this.future.setVV(x0, y0, vx, vz);\r\n            var ebh;\r\n            if (pro.sysBullet.bulletEjection == 1) {\r\n                ebh = Game.map0.chechHit_arr(this.future, Game.map0.Hharr);\r\n                if (ebh) {\r\n                    pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                    pro.setSpeed(0);\r\n                    if (ebh.linkPro_) {\r\n                        pro.hurtValue = 150;\r\n                        ebh.linkPro_.event(Game.Event_Hit, pro);\r\n                        pro.event(Game.Event_Hit, ebh.linkPro_);\r\n                    }\r\n                    this.hitEffect(pro);\r\n                    return false;\r\n                }\r\n                var hits = Game.map0.Aharr;\r\n                ebh = Game.map0.chechHit_arr(this.future, hits);\r\n                if (ebh) {\r\n                    if (pro.gamedata.bounce <= 0) {\r\n                        pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                        pro.setSpeed(0);\r\n                        this.hitEffect(pro);\r\n                        return false;\r\n                    }\r\n                    pro.gamedata.bounce--;\r\n                    if (!Game.map0.chechHit_arr(this.future.setVV(x0, y0, -1 * vx, vz), hits)) {\r\n                        vx = -1 * vx;\r\n                    }\r\n                    else if (!Game.map0.chechHit_arr(this.future.setVV(x0, y0, vx, -1 * vz), hits)) {\r\n                        vz = -1 * vz;\r\n                    }\r\n                    else {\r\n                        this.hitEffect(pro);\r\n                        return false;\r\n                    }\r\n                    n = 2 * Math.PI - Math.atan2(vz, vx);\r\n                    pro.rotation(n);\r\n                }\r\n                pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                return true;\r\n            }\r\n            else {\r\n                ebh = Game.map0.chechHit_arr(this.future, Game.map0.Hharr);\r\n                if (ebh) {\r\n                    pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                    pro.setSpeed(0);\r\n                    if (ebh.linkPro_) {\r\n                        pro.hurtValue = 150;\r\n                        ebh.linkPro_.event(Game.Event_Hit, pro);\r\n                        pro.event(Game.Event_Hit, ebh.linkPro_);\r\n                    }\r\n                    this.hitEffect(pro);\r\n                    return false;\r\n                }\r\n                ebh = Game.map0.chechHit_arr(this.future, Game.map0.Aharr);\r\n                if (ebh) {\r\n                    pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                    pro.setSpeed(0);\r\n                    if (ebh.linkPro_) {\r\n                        pro.hurtValue = 150;\r\n                        ebh.linkPro_.event(Game.Event_Hit, pro);\r\n                        pro.event(Game.Event_Hit, ebh.linkPro_);\r\n                    }\r\n                    this.hitEffect(pro);\r\n                    return false;\r\n                }\r\n                pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n                return true;\r\n            }\r\n        }\r\n        else {\r\n            var heroBox = Game.hero.hbox;\r\n            pro.curLen += speed;\r\n            if (pro.curLen >= pro.moveLen) {\r\n                pro.curLen = pro.moveLen;\r\n            }\r\n            var nn = pro.curLen / pro.moveLen;\r\n            var vx = speed * Math.cos(n);\r\n            var vz = speed * Math.sin(n);\r\n            var dy = Math.sin((Math.PI * nn)) * 2;\r\n            pro.sp3d.transform.localPositionY = 0.1 + dy;\r\n            pro.setXY2D(pro.pos2.x + vx, pro.pos2.z + vz);\r\n            if (heroBox.hit(heroBox, pro.hbox)) {\r\n                if (Game.hero) {\r\n                    pro.hurtValue = 150;\r\n                    Game.hero.event(Game.Event_Hit, pro);\r\n                    pro.event(Game.Event_Hit, Game.hero.hbox.linkPro_);\r\n                    pro.setSpeed(0);\r\n                }\r\n                return false;\r\n            }\r\n            if (pro.curLen == pro.moveLen) {\r\n                this.hitEffect(pro);\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    hitEffect(pro) {\r\n        pro.setSpeed(0);\r\n        if (pro.sysBullet.boomEffect > 0) {\r\n            BoomEffect.getEffect(pro, pro.sysBullet.boomEffect);\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "D:/game01/Layabox/Game3DUP/src/game/Game.ts",
    "D:/game01/Layabox/Game3DUP/src/game/GameHitBox.ts",
    "D:/game01/Layabox/Game3DUP/src/game/GameProType.ts",
    "D:/game01/Layabox/Game3DUP/src/game/GamePro.ts",
    "D:/game01/Layabox/Game3DUP/src/game/move/GameMove.ts",
    "D:/game01/Layabox/Game3DUP/src/game/player/MonsterBullet.ts",
    "D:/game01/Layabox/Game3DUP/src/game/effect/BoomEffect.ts"
  ]
}
