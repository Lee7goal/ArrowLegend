{
  "code": "import GameHitBox from \"../GameHitBox\";\r\nimport GameBG from \"../GameBG\";\r\nimport Game from \"../Game\";\r\nimport MonsterBullet from \"../player/MonsterBullet\";\r\nimport { GameAI } from \"./GameAI\";\r\nexport default class MonsterShooting {\r\n    constructor() {\r\n        this.scd = 0;\r\n        this.shootCd = 1200;\r\n        this.st = 0;\r\n        this.now = 0;\r\n        this.at = 0;\r\n        this.future = new GameHitBox(2, 2);\r\n    }\r\n    short_arrow(r_, pro, proType_, range = 0) {\r\n        var bo = MonsterBullet.getBullet(this._sysBullet);\r\n        bo.curLen = null;\r\n        bo.moveLen = null;\r\n        bo.sp3d.transform.localPositionY = 0.1;\r\n        bo.setXY2D(pro.pos2.x, pro.pos2.z);\r\n        Game.layer3d.addChild(bo.sp3d);\r\n        bo.setSpeed(this._sysBullet.bulletSpeed);\r\n        Game.bloodLayer.graphics.clear();\r\n        bo.rotation(r_);\r\n        bo.curLen = 0;\r\n        bo.hurtValue = pro.hurtValue;\r\n        bo.moveLen = range + Math.sqrt((bo.hbox.cy - Game.hero.hbox.cy) * (bo.hbox.cy - Game.hero.hbox.cy) + (bo.hbox.cx - Game.hero.hbox.cx) * (bo.hbox.cx - Game.hero.hbox.cx));\r\n        bo.startAi();\r\n    }\r\n    get attackOk() {\r\n        this.now = Game.executor.getWorldNow();\r\n        return this.now >= this.st;\r\n    }\r\n    starAttack(pro, acstr) {\r\n        this.pro = pro;\r\n        if (this.attackOk) {\r\n            this.scd = 0;\r\n            pro.play(acstr);\r\n            if (this.at > 0) {\r\n                Laya.stage.timer.frameLoop(this.at, this, this.ac0);\r\n            }\r\n            else {\r\n                this.ac0();\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    cancelAttack() {\r\n        Laya.stage.timer.clear(this, this.ac0);\r\n        this.scd = 0;\r\n    }\r\n    ac0() {\r\n        if (this.pro.normalizedTime >= this.at) {\r\n            if (this.pro.normalizedTime >= 1) {\r\n                Laya.stage.timer.clear(this, this.ac0);\r\n                this.pro.play(GameAI.Idle);\r\n            }\r\n            if (this.scd == 0) {\r\n                this.scd = 1;\r\n                this.pro.event(Game.Event_Short, null);\r\n                this.st = Game.executor.getWorldNow() + this.shootCd;\r\n            }\r\n        }\r\n    }\r\n    checkBallistic(n, pro, ero) {\r\n        var vx = GameBG.mw2 * Math.cos(n);\r\n        var vz = GameBG.mw2 * Math.sin(n);\r\n        var x0 = pro.hbox.cx;\r\n        var y0 = pro.hbox.cy;\r\n        var ebh;\r\n        for (let i = 0; i < 6000; i++) {\r\n            ebh = null;\r\n            this.future.setVV(x0, y0, vx, vz);\r\n            if (ero.hbox.hit(ero.hbox, this.future)) {\r\n                return ero;\r\n            }\r\n            var hits = Game.map0.Aharr;\r\n            ebh = Game.map0.chechHit_arr(this.future, hits);\r\n            if (ebh) {\r\n                return null;\r\n            }\r\n            x0 += vx;\r\n            y0 += vz;\r\n        }\r\n        return null;\r\n    }\r\n}\r\n",
  "references": [
    "D:/gitworker/Game3DUP/src/game/GameHitBox.ts",
    "D:/gitworker/Game3DUP/src/game/GamePro.ts",
    "D:/gitworker/Game3DUP/src/game/GameBG.ts",
    "D:/gitworker/Game3DUP/src/game/Game.ts",
    "D:/gitworker/Game3DUP/src/main/sys/SysBullet.ts",
    "D:/gitworker/Game3DUP/src/core/App.ts",
    "D:/gitworker/Game3DUP/src/game/ai/MonsterBulletAI.ts",
    "D:/gitworker/Game3DUP/src/game/player/MonsterBullet.ts",
    "D:/gitworker/Game3DUP/src/game/ai/GameAI.ts"
  ]
}
